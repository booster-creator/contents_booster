<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Booster</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Boost Your Views on YouTube</h1>
    <p>Search for the keyword</p>
    <input type="text" id="searchInput" placeholder="Enter your keyword">
    <button onclick="searchVideos()">Generate</button>

    <div id="results"></div>

    <script>
    async function searchVideos() {
        const query = document.getElementById('searchInput').value;
        try {
            // Fetch 요청을 보내고 응답을 JSON으로 변환
            const response = await fetch(`/.netlify/functions/search?q=${query}`);

            // 응답이 정상인지 확인
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }

            // JSON 데이터를 파싱
            const data = await response.json();
            
            // 데이터가 없는 경우 처리
            if (!data || data.length === 0) {
                console.log('No data found for the query.');
                return;
            }

            // 검색 결과를 화면에 표시
            displayResults(data);
        } catch (error) {
            console.error('Error during search:', error);
        }
    }

    function displayResults(videos) {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = ''; // 이전 결과 제거

        const table = document.createElement('table');
        table.classList.add('results-table');

        videos.forEach(video => {
            const row = document.createElement('tr');
            row.classList.add('result-row');

            row.innerHTML = `
                <td><img src="${video.snippet.thumbnails.default.url}" alt="${video.snippet.title}"></td>
                <td><a href="https://www.youtube.com/watch?v=${video.id.videoId}" target="_blank">${video.snippet.title}</a></td>
                <td>${video.statistics ? video.statistics.viewCount : 'N/A'}</td>
                <td>${new Date(video.snippet.publishedAt).toLocaleDateString()}</td>
                <td>${video.snippet.channelTitle}</td>
                <td>${video.statistics ? video.statistics.subscriberCount : 'N/A'}</td>
            `;

            table.appendChild(row);
        });

        resultsDiv.appendChild(table);
    }
    </script>
</body>
</html>
